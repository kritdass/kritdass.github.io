---
import { Icon } from "astro-icon/components";
---

<header class="flex items-center justify-between py-2 transition:persist">
    <a
        href="/"
        class="flex items-center text-xl font-bold font-serif pl-1 dark:text-white gap-1.5"
    >
        <span> Krit Dass </span>
        <span>&middot;</span>
        <span> कृत दास </span>
    </a>

    <button
        id="theme-toggle"
        aria-label="Toggle dark mode"
        class="p-2 bg-zinc-200 dark:bg-zinc-700 rounded-full hover:bg-zinc-300 dark:hover:bg-zinc-600"
    >
        <Icon
            name="tabler:moon"
            class="size-6 block dark:hidden text-zinc-900"
        />
        <Icon
            name="tabler:sun"
            class="size-6 hidden dark:block text-yellow-400"
        />
    </button>
</header>

<script>
    function setupThemeToggle() {
        const toggle = document.getElementById("theme-toggle");

        toggle?.addEventListener("click", () => {
            const element = document.documentElement;
            const isDark = element.classList.toggle("dark");

            localStorage.setItem("theme", isDark ? "dark" : "light");

            document.dispatchEvent(new Event("theme-changed"));
        });
    }

    setupThemeToggle();
    document.addEventListener("astro:after-swap", setupThemeToggle);
</script>
